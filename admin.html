<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel - Pesanan Dibayar</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <div class="max-w-5xl mx-auto p-6">
    <h1 class="text-2xl font-bold mb-4">ðŸ“¦ Pesanan yang Sudah Dibayar</h1>
    <div id="orders-container" class="bg-white rounded shadow p-4 overflow-x-auto">
      <table class="min-w-full table-auto text-sm text-left border">
        <thead>
          <tr class="bg-gray-200 text-gray-700">
            <th class="p-2 border">Order ID</th>
            <th class="p-2 border">Nama</th>
            <th class="p-2 border">Email</th>
            <th class="p-2 border">Telepon</th>
            <th class="p-2 border">Jumlah</th>
            <th class="p-2 border">Metode</th>
            <th class="p-2 border">Status</th>
            <th class="p-2 border">Waktu Bayar</th>
          </tr>
        </thead>
        <tbody id="order-rows" class="text-gray-800"></tbody>
      </table>
    </div>
  </div>

  <script>
    async function fetchOrders() {
      try {
        const res = await fetch("https://f232e6c6-0d39-457d-956a-42ef6e8fff59-00-3bgx654x4kes0.pike.replit.dev/api/admin/orders");
        const orders = await res.json();
        const tbody = document.getElementById("order-rows");

        if (orders.length === 0) {
          tbody.innerHTML = `<tr><td colspan="8" class="text-center p-4">Belum ada pesanan dibayar.</td></tr>`;
          return;
        }

        orders.forEach(order => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td class="p-2 border">${order.order_id}</td>
            <td class="p-2 border">${order.name || "-"}</td>
            <td class="p-2 border">${order.email || "-"}</td>
            <td class="p-2 border">${order.phone || "-"}</td>
            <td class="p-2 border">Rp${parseInt(order.amount).toLocaleString("id-ID")}</td>
            <td class="p-2 border capitalize">${order.method}</td>
            <td class="p-2 border font-medium text-green-600">${order.status}</td>
            <td class="p-2 border">${new Date(order.paid_at).toLocaleString("id-ID")}</td>
          `;
          tbody.appendChild(row);
        });
      } catch (err) {
        console.error("Gagal memuat data:", err);
      }
    }

    fetchOrders();
  </script>
</body>
</html>
